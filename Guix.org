#+TITLE: Guix User System Configuration
#+AUTHOR: Jacob Stannix

* Inbox
** Change env to be compatible with Guix
** Install curl  and Starship
#+begin_src sh
  guix install curl
#+end_src

#+begin_src sh
  sh -c "$(curl -fsSL https://starship.rs/install.sh)"
#+end_src
* Channels
** TODO nonguix
:PROPERTIES:
:header-args: :tangle config/.config/guix/channels.scm
:END:
#+begin_src scheme
(cons* (channel
        (name 'nonguix)
        (url "https://gitlab.com/nonguix/nonguix")
        ;; Enable signature verification:
        (introduction
         (make-channel-introduction
          "897c1a470da759236cc11798f4e0a5f7d4d59fbc"
          (openpgp-fingerprint
           "2A39 3FFF 68F4 EF7A 3D29  12AF 6F51 20A0 22FB B2D5"))))
       %default-channels)
#+end_src
* Manifests
** Default
:PROPERTIES:
:header-args: :tangle ./config/.config/guix/manifests/default.scm
:END:
#+begin_src scheme
  (specifications->manifest
   (list "font-abattis-cantarell"
         "font-fira-code"
         "xrandr"
         "zsh"
         "xmodmap"
         "htop"
         "fontconfig"
         "neovim"
         "glibc-locales"))
#+end_src
** Desktop
:PROPERTIES:
:header-args: :tangle ./config/.config/guix/manifests/desktop.scm
:END:
#+begin_src scheme
  (specifications->manifest
    (list "dunst"
          "picom"
          "xclip"
          "firefox"
          "xwallpaper"
          "sxiv"))
#+end_src
** Applications
:PROPERTIES:
:header-args: :tangle config/.config/guix/manifests/applications.scm
:END:
#+begin_src scheme
  (specifications->manifest
   (list "alacritty" 
         "lf"
         "mpv"
         "mpd"
         "qutebrowser"))
#+end_src
* Profiles
:PROPERTIES:
:header-args: :tangle config/.config/guix/active-profiles
:END:
** Guix Profile

#+begin_src sh
export GUIX_PROFILE="$HOME/.config/guix/current"
. "$GUIX_PROFILE/etc/profile"
export GUIX_PROFILE="$HOME/.guix-profile"
. "$GUIX_PROFILE/etc/profile"
export GUIX_LOCPATH="$GUIX_PROFILE/lib/locale"
#+end_src
** Active Profiles
#+begin_src sh 
  GUIX_EXTRA_PROFILES="$HOME"/.guix-extra-profiles
  for i in $GUIX_EXTRA_PROFILES/*; do
    profile=$i/$(basename "$i")
    if [ -f "$profile"/etc/profile ]; then
      GUIX_PROFILE="$profile"
      . "$GUIX_PROFILE"/etc/profile
    fi
    unset profile
  done

  export GUIX_APPLICATIONS="$GUIX_EXTRA_PROFILES"/applications/applications
  export GUIX_EMACS="$GUIX_EXTRA_PROFILES"/emacs/emacs
  export GUIX_DESKTOP="$GUIX_EXTRA_PROFILES"/desktop/desktop
#+end_src

